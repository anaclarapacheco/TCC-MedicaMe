!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common"),require("@angular/core"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("angular-resizable-element",["exports","@angular/common","@angular/core","rxjs","rxjs/operators"],t):t(e["angular-resizable-element"]={},e.ng.common,e.ng.core,e.rxjs,e.rxjs.operators)}(this,function(e,t,r,u,a){"use strict";var l=function(){return(l=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(i=o.next()).done;)s.push(i.value)}catch(l){r={error:l}}finally{try{i&&!i.done&&(n=o["return"])&&n.call(o)}finally{if(r)throw r.error}}return s}var s="undefined"!=typeof window&&("ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints);function c(e,t,n){return void 0===n&&(n=3),Math.abs(e-t)<n}function d(e,t,n,i){var r={top:e.top,bottom:e.bottom,left:e.left,right:e.right};return t.top&&(r.top+=i),t.bottom&&(r.bottom+=i),t.left&&(r.left+=n),t.right&&(r.right+=n),r.height=r.bottom-r.top,r.width=r.right-r.left,r}function h(e){var t=e.clientY,n=e.rect;return t>=n.top&&t<=n.bottom}function m(e){var t=e.clientX,n=e.rect;return t>=n.left&&t<=n.right}function f(e){var t=e.clientX,n=e.clientY,i=e.elm,r=e.allowedEdges,o=e.cursorPrecision,s=i.nativeElement.getBoundingClientRect(),l={};return r.left&&c(t,s.left,o)&&h({clientY:n,rect:s})&&(l.left=!0),r.right&&c(t,s.right,o)&&h({clientY:n,rect:s})&&(l.right=!0),r.top&&c(n,s.top,o)&&m({clientX:t,rect:s})&&(l.top=!0),r.bottom&&c(n,s.bottom,o)&&m({clientX:t,rect:s})&&(l.bottom=!0),l}var g=Object.freeze({topLeft:"nw-resize",topRight:"ne-resize",bottomLeft:"sw-resize",bottomRight:"se-resize",leftOrRight:"col-resize",topOrBottom:"row-resize"});function v(e,t){return e.left&&e.top?t.topLeft:e.right&&e.top?t.topRight:e.left&&e.bottom?t.bottomLeft:e.right&&e.bottom?t.bottomRight:e.left||e.right?t.leftOrRight:e.top||e.bottom?t.topOrBottom:""}function y(e){var t=e.edges,n=e.initialRectangle,i=e.newRectangle,r={};return Object.keys(t).forEach(function(e){r[e]=(i[e]||0)-(n[e]||0)}),r}var b="resize-active",n=function(){function e(e,t,n,i){this.platformId=e,this.renderer=t,this.elm=n,this.zone=i,this.resizeEdges={},this.enableGhostResize=!1,this.resizeSnapGrid={},this.resizeCursors=g,this.resizeCursorPrecision=3,this.ghostElementPositioning="fixed",this.allowNegativeResizes=!1,this.mouseMoveThrottleMS=50,this.resizeStart=new r.EventEmitter,this.resizing=new r.EventEmitter,this.resizeEnd=new r.EventEmitter,this.mouseup=new u.Subject,this.mousedown=new u.Subject,this.mousemove=new u.Subject,this.destroy$=new u.Subject,this.resizeEdges$=new u.Subject,this.pointerEventListeners=o.getInstance(t,i)}return e.prototype.ngOnInit=function(){var o,s=this,e=u.merge(this.pointerEventListeners.pointerDown,this.mousedown),n=u.merge(this.pointerEventListeners.pointerMove,this.mousemove).pipe(a.tap(function(e){var t=e.event;if(o)try{t.preventDefault()}catch(n){}}),a.share()),i=u.merge(this.pointerEventListeners.pointerUp,this.mouseup),r=function(){o&&o.clonedNode&&(s.elm.nativeElement.parentElement.removeChild(o.clonedNode),s.renderer.setStyle(s.elm.nativeElement,"visibility","inherit"))},c=function(){return l({},g,s.resizeCursors)};this.resizeEdges$.pipe(a.startWith(this.resizeEdges),a.map(function(){return s.resizeEdges&&Object.keys(s.resizeEdges).some(function(e){return!!s.resizeEdges[e]})}),a.switchMap(function(e){return e?n:u.EMPTY}),a.auditTime(this.mouseMoveThrottleMS),a.takeUntil(this.destroy$)).subscribe(function(e){var t=f({clientX:e.clientX,clientY:e.clientY,elm:s.elm,allowedEdges:s.resizeEdges,cursorPrecision:s.resizeCursorPrecision}),n=c();if(!o){var i=v(t,n);s.renderer.setStyle(s.elm.nativeElement,"cursor",i)}s.setElementClass(s.elm,"resize-left-hover",!0===t.left),s.setElementClass(s.elm,"resize-right-hover",!0===t.right),s.setElementClass(s.elm,"resize-top-hover",!0===t.top),s.setElementClass(s.elm,"resize-bottom-hover",!0===t.bottom)}),e.pipe(a.mergeMap(function(t){function r(e){return{clientX:e.clientX-t.clientX,clientY:e.clientY-t.clientY}}var l=function(){var e={x:1,y:1};return o&&(s.resizeSnapGrid.left&&o.edges.left?e.x=+s.resizeSnapGrid.left:s.resizeSnapGrid.right&&o.edges.right&&(e.x=+s.resizeSnapGrid.right),s.resizeSnapGrid.top&&o.edges.top?e.y=+s.resizeSnapGrid.top:s.resizeSnapGrid.bottom&&o.edges.bottom&&(e.y=+s.resizeSnapGrid.bottom)),e};function c(e,t){return{x:Math.ceil(e.clientX/t.x),y:Math.ceil(e.clientY/t.y)}}return u.merge(n.pipe(a.take(1)).pipe(a.map(function(e){return[,e]})),n.pipe(a.pairwise())).pipe(a.map(function(e){var t=p(e,2),n=t[0],i=t[1];return[n?r(n):n,r(i)]})).pipe(a.filter(function(e){var t=p(e,2),n=t[0],i=t[1];if(!n)return!0;var r=l(),o=c(n,r),s=c(i,r);return o.x!==s.x||o.y!==s.y})).pipe(a.map(function(e){var t=p(e,2)[1],n=l();return{clientX:Math.round(t.clientX/n.x)*n.x,clientY:Math.round(t.clientY/n.y)*n.y}})).pipe(a.takeUntil(u.merge(i,e)))})).pipe(a.filter(function(){return!!o})).pipe(a.map(function(e){var t=e.clientX,n=e.clientY;return d(o.startingRect,o.edges,t,n)})).pipe(a.filter(function(e){return s.allowNegativeResizes||!!(e.height&&e.width&&0<e.height&&0<e.width)})).pipe(a.filter(function(e){return!s.validateResize||s.validateResize({rectangle:e,edges:y({edges:o.edges,initialRectangle:o.startingRect,newRectangle:e})})}),a.takeUntil(this.destroy$)).subscribe(function(e){o&&o.clonedNode&&(s.renderer.setStyle(o.clonedNode,"height",e.height+"px"),s.renderer.setStyle(o.clonedNode,"width",e.width+"px"),s.renderer.setStyle(o.clonedNode,"top",e.top+"px"),s.renderer.setStyle(o.clonedNode,"left",e.left+"px")),0<s.resizing.observers.length&&s.zone.run(function(){s.resizing.emit({edges:y({edges:o.edges,initialRectangle:o.startingRect,newRectangle:e}),rectangle:e})}),o.currentRect=e}),e.pipe(a.map(function(e){var t=e.clientX,n=e.clientY;return e.edges||f({clientX:t,clientY:n,elm:s.elm,allowedEdges:s.resizeEdges,cursorPrecision:s.resizeCursorPrecision})})).pipe(a.filter(function(e){return 0<Object.keys(e).length}),a.takeUntil(this.destroy$)).subscribe(function(e){o&&r();var t=function l(e,t){var n=0,i=0,r=e.nativeElement.style,o=["transform","-ms-transform","-moz-transform","-o-transform"].map(function(e){return r[e]}).find(function(e){return!!e});if(o&&o.includes("translate")&&(n=o.replace(/.*translate3?d?\((-?[0-9]*)px, (-?[0-9]*)px.*/,"$1"),i=o.replace(/.*translate3?d?\((-?[0-9]*)px, (-?[0-9]*)px.*/,"$2")),"absolute"===t)return{height:e.nativeElement.offsetHeight,width:e.nativeElement.offsetWidth,top:e.nativeElement.offsetTop-i,bottom:e.nativeElement.offsetHeight+e.nativeElement.offsetTop-i,left:e.nativeElement.offsetLeft-n,right:e.nativeElement.offsetWidth+e.nativeElement.offsetLeft-n};var s=e.nativeElement.getBoundingClientRect();return{height:s.height,width:s.width,top:s.top-i,bottom:s.bottom-i,left:s.left-n,right:s.right-n,scrollTop:e.nativeElement.scrollTop,scrollLeft:e.nativeElement.scrollLeft}}(s.elm,s.ghostElementPositioning);o={edges:e,startingRect:t,currentRect:t};var n=c(),i=v(o.edges,n);s.renderer.setStyle(document.body,"cursor",i),s.setElementClass(s.elm,b,!0),s.enableGhostResize&&(o.clonedNode=s.elm.nativeElement.cloneNode(!0),s.elm.nativeElement.parentElement.appendChild(o.clonedNode),s.renderer.setStyle(s.elm.nativeElement,"visibility","hidden"),s.renderer.setStyle(o.clonedNode,"position",s.ghostElementPositioning),s.renderer.setStyle(o.clonedNode,"left",o.startingRect.left+"px"),s.renderer.setStyle(o.clonedNode,"top",o.startingRect.top+"px"),s.renderer.setStyle(o.clonedNode,"height",o.startingRect.height+"px"),s.renderer.setStyle(o.clonedNode,"width",o.startingRect.width+"px"),s.renderer.setStyle(o.clonedNode,"cursor",v(o.edges,n)),s.renderer.addClass(o.clonedNode,"resize-ghost-element"),o.clonedNode.scrollTop=o.startingRect.scrollTop,o.clonedNode.scrollLeft=o.startingRect.scrollLeft),0<s.resizeStart.observers.length&&s.zone.run(function(){s.resizeStart.emit({edges:y({edges:e,initialRectangle:t,newRectangle:t}),rectangle:d(t,{},0,0)})})}),i.pipe(a.takeUntil(this.destroy$)).subscribe(function(){o&&(s.renderer.removeClass(s.elm.nativeElement,b),s.renderer.setStyle(document.body,"cursor",""),s.renderer.setStyle(s.elm.nativeElement,"cursor",""),0<s.resizeEnd.observers.length&&s.zone.run(function(){s.resizeEnd.emit({edges:y({edges:o.edges,initialRectangle:o.startingRect,newRectangle:o.currentRect}),rectangle:o.currentRect})}),r(),o=null)})},e.prototype.ngOnChanges=function(e){e.resizeEdges&&this.resizeEdges$.next(this.resizeEdges)},e.prototype.ngOnDestroy=function(){t.isPlatformBrowser(this.platformId)&&this.renderer.setStyle(document.body,"cursor",""),this.mousedown.complete(),this.mouseup.complete(),this.mousemove.complete(),this.resizeEdges$.complete(),this.destroy$.next()},e.prototype.setElementClass=function(e,t,n){n?this.renderer.addClass(e.nativeElement,t):this.renderer.removeClass(e.nativeElement,t)},e.decorators=[{type:r.Directive,args:[{selector:"[mwlResizable]",exportAs:"mwlResizable"}]}],e.ctorParameters=function(){return[{type:undefined,decorators:[{type:r.Inject,args:[r.PLATFORM_ID]}]},{type:r.Renderer2},{type:r.ElementRef},{type:r.NgZone}]},e.propDecorators={validateResize:[{type:r.Input}],resizeEdges:[{type:r.Input}],enableGhostResize:[{type:r.Input}],resizeSnapGrid:[{type:r.Input}],resizeCursors:[{type:r.Input}],resizeCursorPrecision:[{type:r.Input}],ghostElementPositioning:[{type:r.Input}],allowNegativeResizes:[{type:r.Input}],mouseMoveThrottleMS:[{type:r.Input}],resizeStart:[{type:r.Output}],resizing:[{type:r.Output}],resizeEnd:[{type:r.Output}]},e}(),o=function(){function n(r,o){this.pointerDown=new u.Observable(function(t){var e,n;return o.runOutsideAngular(function(){e=r.listen("document","mousedown",function(e){t.next({clientX:e.clientX,clientY:e.clientY,event:e})}),s&&(n=r.listen("document","touchstart",function(e){t.next({clientX:e.touches[0].clientX,clientY:e.touches[0].clientY,event:e})}))}),function(){e(),s&&n()}}).pipe(a.share()),this.pointerMove=new u.Observable(function(t){var e,n;return o.runOutsideAngular(function(){e=r.listen("document","mousemove",function(e){t.next({clientX:e.clientX,clientY:e.clientY,event:e})}),s&&(n=r.listen("document","touchmove",function(e){t.next({clientX:e.targetTouches[0].clientX,clientY:e.targetTouches[0].clientY,event:e})}))}),function(){e(),s&&n()}}).pipe(a.share()),this.pointerUp=new u.Observable(function(t){var e,n,i;return o.runOutsideAngular(function(){e=r.listen("document","mouseup",function(e){t.next({clientX:e.clientX,clientY:e.clientY,event:e})}),s&&(n=r.listen("document","touchend",function(e){t.next({clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY,event:e})}),i=r.listen("document","touchcancel",function(e){t.next({clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY,event:e})}))}),function(){e(),s&&(n(),i())}}).pipe(a.share())}return n.getInstance=function(e,t){return n.instance||(n.instance=new n(e,t)),n.instance},n}(),i=function(){function e(e,t,n,i){this.renderer=e,this.element=t,this.zone=n,this.resizableDirective=i,this.resizeEdges={},this.eventListeners={},this.destroy$=new u.Subject}return e.prototype.ngOnInit=function(){var t=this;this.zone.runOutsideAngular(function(){t.listenOnTheHost("mousedown").subscribe(function(e){t.onMousedown(e,e.clientX,e.clientY)}),t.listenOnTheHost("mouseup").subscribe(function(e){t.onMouseup(e.clientX,e.clientY)}),s&&(t.listenOnTheHost("touchstart").subscribe(function(e){t.onMousedown(e,e.touches[0].clientX,e.touches[0].clientY)}),u.merge(t.listenOnTheHost("touchend"),t.listenOnTheHost("touchcancel")).subscribe(function(e){t.onMouseup(e.changedTouches[0].clientX,e.changedTouches[0].clientY)}))})},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.unsubscribeEventListeners()},e.prototype.onMousedown=function(e,t,n){var i=this;e.preventDefault(),this.eventListeners.touchmove||(this.eventListeners.touchmove=this.renderer.listen(this.element.nativeElement,"touchmove",function(e){i.onMousemove(e,e.targetTouches[0].clientX,e.targetTouches[0].clientY)})),this.eventListeners.mousemove||(this.eventListeners.mousemove=this.renderer.listen(this.element.nativeElement,"mousemove",function(e){i.onMousemove(e,e.clientX,e.clientY)})),this.resizable.mousedown.next({clientX:t,clientY:n,edges:this.resizeEdges})},e.prototype.onMouseup=function(e,t){this.unsubscribeEventListeners(),this.resizable.mouseup.next({clientX:e,clientY:t,edges:this.resizeEdges})},Object.defineProperty(e.prototype,"resizable",{get:function(){return this.resizableDirective||this.resizableContainer},enumerable:!0,configurable:!0}),e.prototype.onMousemove=function(e,t,n){this.resizable.mousemove.next({clientX:t,clientY:n,edges:this.resizeEdges,event:e})},e.prototype.unsubscribeEventListeners=function(){var t=this;Object.keys(this.eventListeners).forEach(function(e){t.eventListeners[e](),delete t.eventListeners[e]})},e.prototype.listenOnTheHost=function(e){return u.fromEvent(this.element.nativeElement,e).pipe(a.takeUntil(this.destroy$))},e.decorators=[{type:r.Directive,args:[{selector:"[mwlResizeHandle]"}]}],e.ctorParameters=function(){return[{type:r.Renderer2},{type:r.ElementRef},{type:r.NgZone},{type:n,decorators:[{type:r.Optional}]}]},e.propDecorators={resizeEdges:[{type:r.Input}],resizableContainer:[{type:r.Input}]},e}(),z=function(){function e(){}return e.decorators=[{type:r.NgModule,args:[{declarations:[n,i],exports:[n,i]}]}],e}();e.ResizableDirective=n,e.ResizeHandleDirective=i,e.ResizableModule=z,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=angular-resizable-element.umd.min.js.map